f---
title: "myprezdata"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Necessary libraries for the code in each chunk to run.**
```{r}

setwd("/Users/alex/Desktop/fpeds_alex")
library(reactable)
library(tidyverse)
library(readxl)
library(ggplot2)
library(ggthemes)
library(gridExtra)
library(sparkline)
library(dplyr)
library(car)
library(ggpubr)


```


**The following code below is used for my own reference to pull the correct timeframes from online.**
```{r cars}

electionDates <- c("2000-11-7", "2004-11-2", "2008-11-4", "2012-11-6", "2016-11-8")
initData <- as.Date(electionDates) - 90 # this is the date that we will begin tracking the market (also the date that is 3 months before the election for that corresponding year). we will track for a month after the election date.
postData <- as.Date(electionDates) + 30

```


**In the same directory, we have return data on the S&P500, and the top ETFs for each of the 11 market sectors (Consumer Goods, Real Estate, Telecommunications, Utilities, Technology, Industrial, Financial, Energy, Consumer Discretionary, Health Care, Materials). This data spans over 90 days before each election, and 30 days after. Data consists of only years 2000, 2004, 2008, 2012, and 2016. We pull this information, from xlsx files, to use in R.**
```{r}

# Data for S&P500 / Market, each election.
market2000 <- read_excel("electionsp500.xlsx", sheet = "2000")
market2004 <- read_excel("electionsp500.xlsx", sheet = "2004")
market2008 <- read_excel("electionsp500.xlsx", sheet = "2008")
market2012 <- read_excel("electionsp500.xlsx", sheet = "2012")
market2016 <- read_excel("electionsp500.xlsx", sheet = "2016")

#Data for each industry, each election.
consumerGoods2000 <- read_excel("consumerGoodsReturns.xlsx", sheet = "2000")
consumerGoods2004 <- read_excel("consumerGoodsReturns.xlsx", sheet = "2004")
consumerGoods2008 <- read_excel("consumerGoodsReturns.xlsx", sheet = "2008")
consumerGoods2012 <- read_excel("consumerGoodsReturns.xlsx", sheet = "2012")
consumerGoods2016 <- read_excel("consumerGoodsReturns.xlsx", sheet = "2016")

realEstate2000 <- read_excel("realEstateReturns.xlsx", sheet = "2000")
realEstate2004 <- read_excel("realEstateReturns.xlsx", sheet = "2004")
realEstate2008 <- read_excel("realEstateReturns.xlsx", sheet = "2008")
realEstate2012 <- read_excel("realEstateReturns.xlsx", sheet = "2012")
realEstate2016 <- read_excel("realEstateReturns.xlsx", sheet = "2016")

telecommunications2000 <- read_excel("telecommunicationsReturns.xlsx", sheet = "2000")
telecommunications2004 <- read_excel("telecommunicationsReturns.xlsx", sheet = "2004")
telecommunications2008 <- read_excel("telecommunicationsReturns.xlsx", sheet = "2008")
telecommunications2012 <- read_excel("telecommunicationsReturns.xlsx", sheet = "2012")
telecommunications2016 <- read_excel("telecommunicationsReturns.xlsx", sheet = "2016")

utilities2000 <- read_excel("utilitiesReturns.xlsx", sheet = "2000")
utilities2004 <- read_excel("utilitiesReturns.xlsx", sheet = "2004")
utilities2008 <- read_excel("utilitiesReturns.xlsx", sheet = "2008")
utilities2012 <- read_excel("utilitiesReturns.xlsx", sheet = "2012")
utilities2016 <- read_excel("utilitiesReturns.xlsx", sheet = "2016")

technology2000 <- read_excel("technologyReturns.xlsx", sheet = "2000")
technology2004 <- read_excel("technologyReturns.xlsx", sheet = "2004")
technology2008 <- read_excel("technologyReturns.xlsx", sheet = "2008")
technology2012 <- read_excel("technologyReturns.xlsx", sheet = "2012")
technology2016 <- read_excel("technologyReturns.xlsx", sheet = "2016")

industrial2000 <- read_excel("industrialReturns.xlsx", sheet = "2000")
industrial2004 <- read_excel("industrialReturns.xlsx", sheet = "2004")
industrial2008 <- read_excel("industrialReturns.xlsx", sheet = "2008")
industrial2012 <- read_excel("industrialReturns.xlsx", sheet = "2012")
industrial2016 <- read_excel("industrialReturns.xlsx", sheet = "2016")

financial2000 <- read_excel("financialReturns.xlsx", sheet = "2000")
financial2004 <- read_excel("financialReturns.xlsx", sheet = "2004")
financial2008 <- read_excel("financialReturns.xlsx", sheet = "2008")
financial2012 <- read_excel("financialReturns.xlsx", sheet = "2012")
financial2016 <- read_excel("financialReturns.xlsx", sheet = "2016")

energy2000 <- read_excel("energyReturns.xlsx", sheet = "2000")
energy2004 <- read_excel("energyReturns.xlsx", sheet = "2004")
energy2008 <- read_excel("energyReturns.xlsx", sheet = "2008")
energy2012 <- read_excel("energyReturns.xlsx", sheet = "2012")
energy2016 <- read_excel("energyReturns.xlsx", sheet = "2016")

consumerDiscretionary2000 <- read_excel("consumerDiscretionaryReturns.xlsx", sheet = "2000")
consumerDiscretionary2004 <- read_excel("consumerDiscretionaryReturns.xlsx", sheet = "2004")
consumerDiscretionary2008 <- read_excel("consumerDiscretionaryReturns.xlsx", sheet = "2008")
consumerDiscretionary2012 <- read_excel("consumerDiscretionaryReturns.xlsx", sheet = "2012")
consumerDiscretionary2016 <- read_excel("consumerDiscretionaryReturns.xlsx", sheet = "2016")

healthCare2000 <- read_excel("healthCareReturns.xlsx", sheet = "2000")
healthCare2004 <- read_excel("healthCareReturns.xlsx", sheet = "2004")
healthCare2008 <- read_excel("healthCareReturns.xlsx", sheet = "2008")
healthCare2012 <- read_excel("healthCareReturns.xlsx", sheet = "2012")
healthCare2016 <- read_excel("healthCareReturns.xlsx", sheet = "2016")

materials2000 <- read_excel("materialsReturns.xlsx", sheet = "2000")
materials2004 <- read_excel("materialsReturns.xlsx", sheet = "2004")
materials2008 <- read_excel("materialsReturns.xlsx", sheet = "2008")
materials2012 <- read_excel("materialsReturns.xlsx", sheet = "2012")
materials2016 <- read_excel("materialsReturns.xlsx", sheet = "2016")

```

**Now that we have the returns, we want to compare each market sector to the overall market. In Finance (70-391), I have learned about the Greek Beta, also known as the market risk for a stock. In this case, I want to use the top ETFs of each market to make a estimate of the market risk for each sector. The equation for beta is covariance between the stock and the market, divided by the variance of the market. Below we are finding each component of that formula, for each market sector.**
```{r}

# Beta calculations.

beta_consumerGoods2000 <- round((cov(consumerGoods2000$return, market2000$return) / var(market2000$return)), 2)
beta_consumerGoods2004 <- round((cov(consumerGoods2004$return, market2004$return) / var(market2004$return)), 2)
beta_consumerGoods2008 <- round((cov(consumerGoods2008$return, market2008$return) / var(market2008$return)), 2)
beta_consumerGoods2012 <- round((cov(consumerGoods2012$return, market2012$return) / var(market2012$return)), 2)
beta_consumerGoods2016 <- round((cov(consumerGoods2016$return, market2016$return) / var(market2016$return)), 2)

beta_realEstate2000 <- round((cov(realEstate2000$return, market2000$return) / var(market2000$return)), 2)
beta_realEstate2004 <- round((cov(realEstate2004$return, market2004$return) / var(market2004$return)), 2)
beta_realEstate2008 <- round((cov(realEstate2008$return, market2008$return) / var(market2008$return)), 2)
beta_realEstate2012 <- round((cov(realEstate2012$return, market2012$return) / var(market2012$return)), 2)
beta_realEstate2016 <- round((cov(realEstate2016$return, market2016$return) / var(market2016$return)), 2)

beta_telecommunications2000 <- round((cov(telecommunications2000$return, market2000$return) / var(market2000$return)), 2)
beta_telecommunications2004 <- round((cov(telecommunications2004$return, market2004$return) / var(market2004$return)), 2)
beta_telecommunications2008 <- round((cov(telecommunications2008$return, market2008$return) / var(market2008$return)), 2)
beta_telecommunications2012 <- round((cov(telecommunications2012$return, market2012$return) / var(market2012$return)), 2)
beta_telecommunications2016 <- round((cov(telecommunications2016$return, market2016$return) / var(market2016$return)), 2)

beta_utilities2000 <- round((cov(utilities2000$return, market2000$return) / var(market2000$return)), 2)
beta_utilities2004 <- round((cov(utilities2004$return, market2004$return) / var(market2004$return)), 2)
beta_utilities2008 <- round((cov(utilities2008$return, market2008$return) / var(market2008$return)), 2)
beta_utilities2012 <- round((cov(utilities2012$return, market2012$return) / var(market2012$return)), 2)
beta_utilities2016 <- round((cov(utilities2016$return, market2016$return) / var(market2016$return)), 2)

beta_technology2000 <- round((cov(technology2000$return, market2000$return) / var(market2000$return)), 2)
beta_technology2004 <- round((cov(technology2004$return, market2004$return) / var(market2004$return)), 2)
beta_technology2008 <- round((cov(technology2008$return, market2008$return) / var(market2008$return)), 2)
beta_technology2012 <- round((cov(technology2012$return, market2012$return) / var(market2012$return)), 2)
beta_technology2016 <- round((cov(technology2016$return, market2016$return) / var(market2016$return)), 2)

beta_industrial2000 <- round((cov(industrial2000$return, market2000$return) / var(market2000$return)), 2)
beta_industrial2004 <- round((cov(industrial2004$return, market2004$return) / var(market2004$return)), 2)
beta_industrial2008 <- round((cov(industrial2008$return, market2008$return) / var(market2008$return)), 2)
beta_industrial2012 <- round((cov(industrial2012$return, market2012$return) / var(market2012$return)), 2)
beta_industrial2016 <- round((cov(industrial2016$return, market2016$return) / var(market2016$return)), 2)

beta_financial2000 <- round((cov(financial2000$return, market2000$return) / var(market2000$return)), 2)
beta_financial2004 <- round((cov(financial2004$return, market2004$return) / var(market2004$return)), 2)
beta_financial2008 <- round((cov(financial2008$return, market2008$return) / var(market2008$return)), 2)
beta_financial2012 <- round((cov(financial2012$return, market2012$return) / var(market2012$return)), 2)
beta_financial2016 <- round((cov(financial2016$return, market2016$return) / var(market2016$return)), 2)

beta_energy2000 <- round((cov(energy2000$return, market2000$return) / var(market2000$return)), 2)
beta_energy2004 <- round((cov(energy2004$return, market2004$return) / var(market2004$return)), 2)
beta_energy2008 <- round((cov(energy2008$return, market2008$return) / var(market2008$return)), 2)
beta_energy2012 <- round((cov(energy2012$return, market2012$return) / var(market2012$return)), 2)
beta_energy2016 <- round((cov(energy2016$return, market2016$return) / var(market2016$return)), 2)

beta_consumerDiscretionary2000 <- round((cov(consumerDiscretionary2000$return, market2000$return) / var(market2000$return)), 2)
beta_consumerDiscretionary2004 <- round((cov(consumerDiscretionary2004$return, market2004$return) / var(market2004$return)), 2)
beta_consumerDiscretionary2008 <- round((cov(consumerDiscretionary2008$return, market2008$return) / var(market2008$return)), 2)
beta_consumerDiscretionary2012 <- round((cov(consumerDiscretionary2012$return, market2012$return) / var(market2012$return)), 2)
beta_consumerDiscretionary2016 <- round((cov(consumerDiscretionary2016$return, market2016$return) / var(market2016$return)), 2)

beta_healthCare2000 <- round((cov(healthCare2000$return, market2000$return) / var(market2000$return)), 2)
beta_healthCare2004 <- round((cov(healthCare2004$return, market2004$return) / var(market2004$return)), 2)
beta_healthCare2008 <- round((cov(healthCare2008$return, market2008$return) / var(market2008$return)), 2)
beta_healthCare2012 <- round((cov(healthCare2012$return, market2012$return) / var(market2012$return)), 2)
beta_healthCare2016 <- round((cov(healthCare2016$return, market2016$return) / var(market2016$return)), 2)

beta_materials2000 <- round((cov(materials2000$return, market2000$return) / var(market2000$return)), 2)
beta_materials2004 <- round((cov(materials2004$return, market2004$return) / var(market2004$return)), 2)
beta_materials2008 <- round((cov(materials2008$return, market2008$return) / var(market2008$return)), 2)
beta_materials2012 <- round((cov(materials2012$return, market2012$return) / var(market2012$return)), 2)
beta_materials2016 <- round((cov(materials2016$return, market2016$return) / var(market2016$return)), 2)

```

**We have overall Beta calculations for each election, and for each market sector. It is nice to physically see these numbers, so we will create aesthetic visualizations for each sector's beta tracked over discrete (every four years) time.**

**Each graph shows each point as roughly green or roughly red. Roughly green means that the market risk is low (beta is low). Roughly red means that the market risk is high (beta is high).**
```{r}
# Below is data for each market sector. I will write comments for only Consumer Goods (every other sector is identical with the exception of its name).

# x-axis data.
electionYears <- c("2000", "2004", "2008", "2012", "2016")

# y-axis data for Consumer Goods.
values_consumerGoodsBeta <- c(beta_consumerGoods2000, beta_consumerGoods2004, beta_consumerGoods2008, beta_consumerGoods2012, beta_consumerGoods2016)

# Turn x-axis and y-axis data into a data frame to use for ggplot2.
betas_consumerGoods <- data.frame(electionYears, values_consumerGoodsBeta)

mid = 0 # Used to create multiple gradients in one plot. Since beta can be negative or positive, the a beta of 0 means no market risk whatsoever. Thus, the midpoint is 0.

betasPlot_consumerGoods <- ggplot(data = betas_consumerGoods, aes(x = electionYears, y = values_consumerGoodsBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_consumerGoodsBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") + # the gradient ranges from -2.5 to 2.5. Thus, -2.5 or 2.5 is pure red and anything in between is a mixture of green and red, depending on the value.
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") + # changed the y-axis label to 'Beta' with the addition of the actual Greek letter.
  xlab("Election Year") + # changed the x-axis label to 'Election Year'.
    labs(title = "Market risk of the consumer goods sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) + # changed title font size and made bold as well to stand out
  theme_solarized() + # changed the theme of the entire plot to make it more appealing rather than just black and white.
  theme(legend.position="none") # got rid of the legend because it is unnecessary.

values_realEstateBeta <- c(beta_realEstate2000, beta_realEstate2004, beta_realEstate2008, beta_realEstate2012, beta_realEstate2016)
betas_realEstate <- data.frame(electionYears, values_realEstateBeta)


betasPlot_realEstate <- ggplot(data = betas_realEstate, aes(x = electionYears, y = values_realEstateBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_realEstateBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the real estate sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_telecommunicationsBeta <- c(beta_telecommunications2000, beta_telecommunications2004, beta_telecommunications2008, beta_telecommunications2012, beta_telecommunications2016)
betas_telecommunications <- data.frame(electionYears, values_telecommunicationsBeta)
betasPlot_telecommunications <- ggplot(data = betas_telecommunications, aes(x = electionYears, y = values_telecommunicationsBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_telecommunicationsBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the telecommunications sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_utilitiesBeta <- c(beta_utilities2000, beta_utilities2004, beta_utilities2008, beta_utilities2012, beta_utilities2016)
betas_utilities <- data.frame(electionYears, values_utilitiesBeta)
betasPlot_utilities <- ggplot(data = betas_utilities, aes(x = electionYears, y = values_utilitiesBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_utilitiesBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the utilities sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_technologyBeta <- c(beta_technology2000, beta_technology2004, beta_technology2008, beta_technology2012, beta_technology2016)
betas_technology <- data.frame(electionYears, values_technologyBeta)
betasPlot_technology <- ggplot(data = betas_technology, aes(x = electionYears, y = values_technologyBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_technologyBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the technology sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_industrialBeta <- c(beta_industrial2000, beta_industrial2004, beta_industrial2008, beta_industrial2012, beta_industrial2016)
betas_industrial <- data.frame(electionYears, values_industrialBeta)
betasPlot_industrial <- ggplot(data = betas_industrial, aes(x = electionYears, y = values_industrialBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_industrialBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the industrial sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_financialBeta <- c(beta_financial2000, beta_financial2004, beta_financial2008, beta_financial2012, beta_financial2016)
betas_financial <- data.frame(electionYears, values_financialBeta)
betasPlot_financial <- ggplot(data = betas_financial, aes(x = electionYears, y = values_financialBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_financialBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the financial sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_energyBeta <- c(beta_energy2000, beta_energy2004, beta_energy2008, beta_energy2012, beta_energy2016)
betas_energy <- data.frame(electionYears, values_energyBeta)
betasPlot_energy <- ggplot(data = betas_energy, aes(x = electionYears, y = values_energyBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_energyBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the energy sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_consumerDiscretionaryBeta <- c(beta_consumerDiscretionary2000, beta_consumerDiscretionary2004, beta_consumerDiscretionary2008, beta_consumerDiscretionary2012, beta_consumerDiscretionary2016)
betas_consumerDiscretionary <- data.frame(electionYears, values_consumerDiscretionaryBeta)
betasPlot_consumerDiscretionary <- ggplot(data = betas_consumerDiscretionary, aes(x = electionYears, y = values_consumerDiscretionaryBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_consumerDiscretionaryBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the consumer discretionary sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_healthCareBeta <- c(beta_healthCare2000, beta_healthCare2004, beta_healthCare2008, beta_healthCare2012, beta_healthCare2016)
betas_healthCare <- data.frame(electionYears, values_healthCareBeta)
betasPlot_healthCare <- ggplot(data = betas_healthCare, aes(x = electionYears, y = values_healthCareBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_healthCareBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the health care sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

values_materialsBeta <- c(beta_materials2000, beta_materials2004, beta_materials2008, beta_materials2012, beta_materials2016)
betas_materials <- data.frame(electionYears, values_materialsBeta)
betasPlot_materials <- ggplot(data = betas_materials, aes(x = electionYears, y = values_materialsBeta, group = 1)) +
  geom_line(linetype = "dotted") + 
  geom_point(aes(colour = values_materialsBeta), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the materials sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

#Graphing each plot.
betasPlot_consumerGoods
betasPlot_realEstate
betasPlot_telecommunications
betasPlot_utilities
betasPlot_technology
betasPlot_industrial
betasPlot_financial
betasPlot_energy
betasPlot_consumerDiscretionary
betasPlot_healthCare
betasPlot_materials

```

**We have just graphed individual betas that shows each sector's market risk. We want to aggregate this information to show how every market, holistically, is changing over time.**
```{r}

values_aggregateBeta <- c(values_consumerGoodsBeta, values_realEstateBeta, values_telecommunicationsBeta, values_utilitiesBeta, values_technologyBeta, values_industrialBeta, values_financialBeta, values_energyBeta, values_consumerDiscretionaryBeta, values_healthCareBeta, values_materialsBeta) # y-axis of every single Beta, length is 11*5 = 55.
betas_aggregate <- data.frame(electionYears, values_aggregateBeta) # create the data frame to work with. Although electionYears has length 5, this is fine, because it loops over until both columns have the same length.

#The formatting of the code below is the same as the chunk above.
betasPlot_aggregate <- ggplot(data = betas_aggregate, aes(x = electionYears, y = values_aggregateBeta, group = 1)) +
  geom_point(aes(colour = values_aggregateBeta), size = 4) +
  geom_smooth(method = "lm") +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Holistic view of the market risk of each sector, as represented by Beta", subtitle = "(tracked 90 days before and 30 days after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")

#Graph the plot.
betasPlot_aggregate

```

**We have very nice visualizations for the beta. I want to provide the reader of this code the specific numbers of each beta, however, since the visualizations do not show specific values. Therefore, we will create a table to show the betas.**
```{r}

winners <- c("Republican", "Republican", "Democrat", "Democrat", "Republican") # the political party winner for 2000, 2004, 2008, 2012, 2016

betaTable <- data.frame(electionYears, winners, values_consumerGoodsBeta, values_realEstateBeta, values_telecommunicationsBeta, values_utilitiesBeta, values_technologyBeta, values_industrialBeta, values_financialBeta, values_energyBeta, values_consumerDiscretionaryBeta, values_healthCareBeta, values_materialsBeta) # I made a raw table for my data, which I will then use with the 'reactable' package to make it prettier.


# reactable table settings

options(reactable.theme = reactableTheme(
  backgroundColor = "#fdf6e3",
  style = list(fontFamily = "-apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif", "font-size"="0.7em"),
))

# implementing the actual table
reactable(
  betaTable[1:5, ],
  defaultPageSize = 5,
  bordered = FALSE,
  resizable = TRUE,
  wrap = FALSE,
  fullWidth = TRUE,
  defaultColDef = colDef(footer = function(values) {
    if (!is.numeric(values)) return()
    sparkline(values, type = "line", minWidth = 70, height = 20)
  },
  minWidth = 40),
  columns = list(
    electionYears = colDef(name = "Year"),
    winners = colDef(name = "Winner"),
    values_consumerGoodsBeta = colDef(name = "Consumer\nGoods", width = 120),
    values_realEstateBeta = colDef(name = "Real Estate"),
    values_telecommunicationsBeta = colDef(name = "Telecommunications", width = 120),
    values_utilitiesBeta = colDef(name = "Utilities"),
    values_technologyBeta = colDef(name = "Technology"),
    values_industrialBeta = colDef(name = "Industrial"),
    values_financialBeta = colDef(name = "Financial"),
    values_energyBeta = colDef(name = "Energy"),
    values_consumerDiscretionaryBeta = colDef(name = "Consumer\nDiscretionary", width = 120),
    values_healthCareBeta = colDef(name = "Health Care"),
    values_materialsBeta = colDef(name = "Materials")),
  columnGroups = list(
    colGroup(name = "Beta", columns = c("values_consumerGoodsBeta", "values_realEstateBeta", "values_telecommunicationsBeta", "values_utilitiesBeta", "values_technologyBeta", "values_industrialBeta", "values_financialBeta", "values_energyBeta", "values_consumerDiscretionaryBeta", "values_healthCareBeta", "values_materialsBeta")), colGroup(name = "Election Information", columns = c("electionYears", "winners"))))

```

**We made a table for each individual beta. It is now a good idea to make a table for some other information and make our analysis more extensive. Therefore, we will look into political data more closely.**
```{r}

sectors <- c("Consumer Goods", "Real Estate", "Telecommunications", "Utilities", "Technology", "Industrial", "Financial", "Energy", "Consumer Discretionary", "Health Care", "Materials")

# Standard deviation calculation for each sector's beta.
sdBeta <- round(c(sd(values_consumerGoodsBeta),
sd(values_realEstateBeta),
sd(values_telecommunicationsBeta),
sd(values_utilitiesBeta),
sd(values_technologyBeta),
sd(values_industrialBeta),
sd(values_financialBeta),
sd(values_energyBeta),
sd(values_consumerDiscretionaryBeta),
sd(values_healthCareBeta),
sd(values_materialsBeta)), 2)

# Mean calculation for each sector's beta.
averageBeta <- round(c(mean(values_consumerGoodsBeta),
mean(values_realEstateBeta),
mean(values_telecommunicationsBeta),
mean(values_utilitiesBeta),
mean(values_technologyBeta),
mean(values_industrialBeta),
mean(values_financialBeta),
mean(values_energyBeta),
mean(values_consumerDiscretionaryBeta),
mean(values_healthCareBeta),
mean(values_materialsBeta)), 2)

# Mean calculation for each sector's beta during each year a Democrat candidate won.
averageBetaDemocrat <- round(
  c(
    mean(c(beta_consumerGoods2008, beta_consumerGoods2012)),
    mean(c(beta_realEstate2008, beta_realEstate2012)),
    mean(c(beta_telecommunications2008, beta_telecommunications2012)),
    mean(c(beta_utilities2008, beta_utilities2012)),
    mean(c(beta_technology2008, beta_technology2012)),
    mean(c(beta_industrial2008, beta_industrial2012)),
    mean(c(beta_financial2008, beta_financial2012)),
    mean(c(beta_energy2008, beta_energy2012)),
    mean(c(beta_consumerDiscretionary2008, beta_consumerDiscretionary2012)),
    mean(c(beta_healthCare2008, beta_healthCare2012)),
    mean(c(beta_materials2008, beta_materials2012))), 2)

# Mean calculation for each sector's beta during each year a Republican candidate won.
averageBetaRepublican <- round(
  c(
    mean(c(beta_consumerGoods2000, beta_consumerGoods2004, beta_consumerGoods2016)),
    mean(c(beta_realEstate2000, beta_realEstate2004, beta_realEstate2016)),
    mean(c(beta_telecommunications2000, beta_telecommunications2004, beta_telecommunications2016)),
    mean(c(beta_utilities2000, beta_utilities2004, beta_utilities2016)),
    mean(c(beta_technology2000, beta_technology2004, beta_technology2016)),
    mean(c(beta_industrial2000, beta_industrial2004, beta_industrial2016)),
    mean(c(beta_financial2000, beta_financial2004, beta_financial2016)),
    mean(c(beta_energy2000, beta_energy2004, beta_energy2016)),
    mean(c(beta_consumerDiscretionary2000, beta_consumerDiscretionary2004, beta_consumerDiscretionary2016)),
    mean(c(beta_healthCare2000, beta_healthCare2004, beta_healthCare2016)),
    mean(c(beta_materials2000, beta_materials2004, beta_materials2016))), 2)

# The difference between each sector's beta depending on political party winner. 
differenceOfParties <- abs(averageBetaRepublican- averageBetaDemocrat)

# Made a new and improved table that will be used with the 'reactable' package to make similar changes as seen with the previous tables.
sectorTable <- data.frame(sectors, differenceOfParties, averageBeta, sdBeta, averageBetaDemocrat, averageBetaRepublican)

# Arranged the table in order depending on the standard deviation of the betas to see more easily which sector had the highest (lowest) standard deviation in beta.
sectorTable <- sectorTable %>%
  arrange(desc(differenceOfParties))

options(reactable.theme = reactableTheme(
  backgroundColor = "#fdf6e3",
  style = list(fontFamily = "-apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif", "font-size"="0.7em"),
))

reactableSectorTable <- reactable(
  sectorTable[1:11, ],
  defaultPageSize = 11,
  bordered = FALSE,
  resizable = TRUE,
  wrap = FALSE,
  fullWidth = FALSE,
  columns = list(sectors = colDef(name = "Sectors", width = 150),
                 differenceOfParties = colDef(name = "Difference (R-D)", width = 110),
                 averageBeta = colDef(name = "Average", width = 100),
                 sdBeta = colDef(name = "Std. Dev.", width = 100),
                 averageBetaDemocrat = colDef("Avg. w/ Democrat"),
                 averageBetaRepublican = colDef("Avg. w/ Republican")),
  defaultColDef = colDef(format = colFormat(separators = TRUE, digits = 2), footer = function(values) {
    if (!is.numeric(values)) return()
    sparkline(values, type = "line", minWidth = 40, height = 25)
  },
  minWidth = 130)
)
reactableSectorTable

average_versus_differenceOfParties <- lm(averageBeta ~ differenceOfParties, data = sectorTable)  #Creates a linear model
coefficients(average_versus_differenceOfParties) # as the difference between the average of the two parties' betas grows, the std dev of the Beta in general grows, meaning that some sectors are much more risky depending on which party wins
residualPlots(average_versus_differenceOfParties)
qqPlot(average_versus_differenceOfParties)

```

**As we can see from the table, the Technology, Health Care, Real Estate, and Energy are the main industries largely affected by which candidate wins. Specifically the Technology and Health Care industries have a lot more market risk if a Republican candidate wins rather than a Democrat. The Real Estate and Energy industries have a lot more market risk if a Democrat candidate wins rather than a Republican.**

**Let us go further into these five industries and introduce a different data set that examines how many votes were cast for each political party.**
```{r}
options(dplyr.summarise.inform = FALSE) # to get rid of a warning from group_by
# county is a data set that includes information on each county's polls (such as how many votes were cast for each political candidate). We will use this information to see how many votes were cast for the Democratic and Republican party for 2000, 2004, 2008, 2012, and 2016. Finally, we will compare each election to see if a winner won by a large margin or not (landslide victory). 
county <- read.csv("countypres_2000-2016.csv")
county
updatedCountyData <- county %>%
  group_by(year, state, party) %>%
  summarize(partyTotalVotes = sum(candidatevotes)) %>%
  na.omit() %>%
  group_by(year, party) %>%
  summarize(sumPerParty = sum(partyTotalVotes))
updatedCountyData

demData <- updatedCountyData %>%
  filter(party == "democrat")
demData # table that shows how many votes were cast for the Democratic party each year.

repData <- updatedCountyData %>%
  filter(party == "republican")
repData # table that shows how many votes were cast for the Republican party each year.

diffPartyData <- repData$sumPerParty - demData$sumPerParty
diffPartyData # table that shows how many more votes the Republican party received each year.

totVotesData <- county %>%
  na.omit() %>%
  filter(party != "green") %>% # to look at only Republican and Democratic votes
  group_by(year) %>%
  summarize(totalvotesPerYear = sum(candidatevotes))
totVotesData # table that shows the total amount of votes that were cast for a Democrat or Republican.

percentDiff <- 100*(diffPartyData / totVotesData$totalvotesPerYear) # calculates the percent margin of the election, such as in the 2000 presidential election, the Republican party received 0.2996683% less votes than the Democratic party.
percentDiff
df_percentDiff <- data.frame(electionYears, percentDiff)

#Colour Palette
pal <- c(
  "Republican" = "red",
  "Democrat" = "blue" 
)

df_percentDiff %>%
  ggplot(aes(x = electionYears, y = percentDiff, fill = winners)) + 
  geom_col() + 
  scale_x_discrete(limits = rev(levels(df_percentDiff$electionYears))) +
  scale_fill_manual(
    values = pal,
    limits = names(pal)
  ) +
  ylab("Republican Public Vote Margin") +
  xlab("Election Year") +
labs(title = "Margin of Republican Public Votes per Year of Election") +
    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized() 

```

**Now that we know if a candidate received a larger or smaller margin of the public vote, we can see if there is a relationship between a "landslide" election versus the volatility of the five sectors that we have predicted to be politically significant. To do so, we can create a linear regression model between the sector beta that year, and the win differential (in percent) that year.**
```{r}

# Technology
technologyBeta_versus_winPercent <- lm(values_technologyBeta ~ percentDiff)
technologyLandslideData <- data.frame(percentDiff, values_technologyBeta)
technologyLandslideDataPlot <- ggplot(data = technologyLandslideData, aes(x = percentDiff, y = values_technologyBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of technology sector versus % won (or lost) by a Republican candidate")



healthCareBeta_versus_winPercent <- lm(values_healthCareBeta ~ percentDiff)
healthCareLandslideData <- data.frame(percentDiff, values_healthCareBeta)
healthCareLandslideDataPlot <- ggplot(data = healthCareLandslideData, aes(x = percentDiff, y = values_healthCareBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of health care sector versus % won (or lost) by a Republican candidate")


realEstateBeta_versus_winPercent <- lm(values_realEstateBeta ~ percentDiff)
realEstateLandslideData <- data.frame(percentDiff, values_realEstateBeta)
realEstateLandslideDataPlot <- ggplot(data = realEstateLandslideData, aes(x = percentDiff, y = values_realEstateBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of real estate sector versus % won (or lost) by a Republican candidate")


energyBeta_versus_winPercent <- lm(values_energyBeta ~ percentDiff)
energyLandslideData <- data.frame(percentDiff, values_energyBeta)
energyLandslideDataPlot <- ggplot(data = energyLandslideData, aes(x = percentDiff, y = values_energyBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of energy sector versus % won (or lost) by a Republican candidate")
energyBeta_versus_winPercent

consumerGoodsBeta_versus_winPercent <- lm(values_consumerGoodsBeta ~ percentDiff)
consumerGoodsLandslideData <- data.frame(percentDiff, values_consumerGoodsBeta)
consumerGoodsLandslideDataPlot <- ggplot(data = consumerGoodsLandslideData, aes(x = percentDiff, y = values_consumerGoodsBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of consumer goods sector versus % won (or lost) by a Republican candidate")
consumerGoodsBeta_versus_winPercent


telecommunicationsBeta_versus_winPercent <- lm(values_telecommunicationsBeta ~ percentDiff)
telecommunicationsLandslideData <- data.frame(percentDiff, values_telecommunicationsBeta)
telecommunicationsLandslideDataPlot <- ggplot(data = telecommunicationsLandslideData, aes(x = percentDiff, y = values_telecommunicationsBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of telecommunications sector versus % won (or lost) by a Republican candidate")



utilitiesBeta_versus_winPercent <- lm(values_utilitiesBeta ~ percentDiff)
utilitiesLandslideData <- data.frame(percentDiff, values_utilitiesBeta)
utilitiesLandslideDataPlot <- ggplot(data = utilitiesLandslideData, aes(x = percentDiff, y = values_utilitiesBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of utilities sector versus % won (or lost) by a Republican candidate")


industrialBeta_versus_winPercent <- lm(values_industrialBeta ~ percentDiff)
industrialLandslideData <- data.frame(percentDiff, values_industrialBeta)
industrialLandslideDataPlot <- ggplot(data = industrialLandslideData, aes(x = percentDiff, y = values_industrialBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of industrial sector versus % won (or lost) by a Republican candidate")


financialBeta_versus_winPercent <- lm(values_financialBeta ~ percentDiff)
financialLandslideData <- data.frame(percentDiff, values_financialBeta)
financialLandslideDataPlot <- ggplot(data = financialLandslideData, aes(x = percentDiff, y = values_financialBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of financial sector versus % won (or lost) by a Republican candidate")


consumerDiscretionaryBeta_versus_winPercent <- lm(values_consumerDiscretionaryBeta ~ abs(percentDiff))
consumerDiscretionaryLandslideData <- data.frame(percentDiff, values_consumerDiscretionaryBeta)
consumerDiscretionaryLandslideDataPlot <- ggplot(data = consumerDiscretionaryLandslideData, aes(x = percentDiff, y = values_consumerDiscretionaryBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of consumer discretionary sector versus % won (or lost) by a Republican candidate")


materialsBeta_versus_winPercent <- lm(values_materialsBeta ~ percentDiff)
materialsLandslideData <- data.frame(percentDiff, values_materialsBeta)
materialsLandslideDataPlot <- ggplot(data = materialsLandslideData, aes(x = percentDiff, y = values_materialsBeta)) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
  ggtitle("Beta of materials sector versus % won (or lost) by a Republican candidate")

coefficients(consumerGoodsBeta_versus_winPercent)

landslideDataIntercepts <- c(
coefficients(realEstateBeta_versus_winPercent)[1],
coefficients(technologyBeta_versus_winPercent)[1],
coefficients(financialBeta_versus_winPercent)[1],
coefficients(energyBeta_versus_winPercent)[1],
coefficients(healthCareBeta_versus_winPercent)[1],
coefficients(materialsBeta_versus_winPercent)[1]
)

landslideDataSlopes <- c(
coefficients(realEstateBeta_versus_winPercent)[2],
coefficients(technologyBeta_versus_winPercent)[2],
coefficients(financialBeta_versus_winPercent)[2],
coefficients(energyBeta_versus_winPercent)[2],
coefficients(healthCareBeta_versus_winPercent)[2],
coefficients(materialsBeta_versus_winPercent)[2]
)
significantSectors <- c("Energy", "Technology", "Real Estate", "Materials", "Financial", "Health Care")

landslideTable <- data.frame(significantSectors, landslideDataIntercepts, landslideDataSlopes)



reactableLandslideTable <- reactable(
  landslideTable[1:6, ],
  defaultPageSize = 6,
  bordered = FALSE,
  resizable = TRUE,
  wrap = FALSE,
  fullWidth = FALSE,
  columns = list(significantSectors = colDef(name = "Sectors", width = 150),
                 landslideDataIntercepts = colDef(name = "Regression Intercepts", width = 170),
                 landslideDataSlopes = colDef(name = "Regression Slopes", width = 170)
                 ),
  defaultColDef = colDef(format = colFormat(separators = TRUE, digits = 2), footer = function(values) {
    if (!is.numeric(values)) return()
    sparkline(values, type = "line", minWidth = 40, height = 25)
  },
  minWidth = 130)
)
reactableLandslideTable


```

**We now can make a prediction about the market risk depending on the political party winner. Now let us see how the market responds before and after the election. We will compute the beta values from 90 days before and then 30 days after each election.**
```{r}

electionDates <- c("2000-11-7", "2004-11-2", "2008-11-4", "2012-11-6", "2016-11-8")
initData <- as.Date(electionDates) - 90 # this is the date that we will begin tracking the market (also the date that is 3 months before the election for that corresponding year). we will track for a month after the election date.
postData <- as.Date(electionDates) + 30
df <- data.frame(consumerGoods2000)
dateSimple <- as.integer(unlist(df[2]))
dateSimple <- as.numeric(dateSimple)
#consumerGoods2000$return[1:64] # I was having a lot of trouble with the indeces. The date column is not a string and so I wasn't able to do which to find the index to go through. Thus, I hard coded the indeces by looking at the xlsx files.
#consumerGoods2004$return[1:64]
#consumerGoods2008$return[1:64]
#consumerGoods2012$return[1:62]
#consumerGoods2016$return[1:64]

beta_consumerGoods2000_90 <- round((cov(consumerGoods2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_consumerGoods2004_90 <- round((cov(consumerGoods2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_consumerGoods2008_90 <- round((cov(consumerGoods2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_consumerGoods2012_90 <- round((cov(consumerGoods2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_consumerGoods2016_90 <- round((cov(consumerGoods2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_realEstate2000_90 <- round((cov(realEstate2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_realEstate2004_90 <- round((cov(realEstate2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_realEstate2008_90<- round((cov(realEstate2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_realEstate2012_90 <- round((cov(realEstate2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_realEstate2016_90 <- round((cov(realEstate2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_telecommunications2000_90 <- round((cov(telecommunications2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_telecommunications2004_90 <- round((cov(telecommunications2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_telecommunications2008_90 <- round((cov(telecommunications2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_telecommunications2012_90 <- round((cov(telecommunications2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_telecommunications2016_90 <- round((cov(telecommunications2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_utilities2000_90 <- round((cov(utilities2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_utilities2004_90 <- round((cov(utilities2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_utilities2008_90 <- round((cov(utilities2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_utilities2012_90 <- round((cov(utilities2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_utilities2016_90 <- round((cov(utilities2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_technology2000_90 <- round((cov(technology2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_technology2004_90 <- round((cov(technology2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_technology2008_90 <- round((cov(technology2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_technology2012_90 <- round((cov(technology2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_technology2016_90 <- round((cov(technology2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_industrial2000_90 <- round((cov(industrial2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_industrial2004_90 <- round((cov(industrial2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_industrial2008_90 <- round((cov(industrial2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_industrial2012_90 <- round((cov(industrial2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_industrial2016_90 <- round((cov(industrial2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_financial2000_90 <- round((cov(financial2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_financial2004_90 <- round((cov(financial2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_financial2008_90 <- round((cov(financial2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_financial2012_90 <- round((cov(financial2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_financial2016_90 <- round((cov(financial2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_energy2000_90 <- round((cov(energy2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_energy2004_90 <- round((cov(energy2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_energy2008_90 <- round((cov(energy2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_energy2012_90 <- round((cov(energy2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_energy2016_90 <- round((cov(energy2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_consumerDiscretionary2000_90 <- round((cov(consumerDiscretionary2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_consumerDiscretionary2004_90 <- round((cov(consumerDiscretionary2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_consumerDiscretionary2008_90 <- round((cov(consumerDiscretionary2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_consumerDiscretionary2012_90 <- round((cov(consumerDiscretionary2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_consumerDiscretionary2016_90 <- round((cov(consumerDiscretionary2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_healthCare2000_90 <- round((cov(healthCare2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_healthCare2004_90 <- round((cov(healthCare2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_healthCare2008_90 <- round((cov(healthCare2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_healthCare2012_90 <- round((cov(healthCare2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_healthCare2016_90 <- round((cov(healthCare2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)

beta_materials2000_90 <- round((cov(materials2000$return[1:64], market2000$return[1:64]) / var(market2000$return[1:64])), 2)
beta_materials2004_90 <- round((cov(materials2004$return[1:64], market2004$return[1:64]) / var(market2004$return[1:64])), 2)
beta_materials2008_90 <- round((cov(materials2008$return[1:64], market2008$return[1:64]) / var(market2008$return[1:64])), 2)
beta_materials2012_90 <- round((cov(materials2012$return[1:62], market2012$return[1:62]) / var(market2012$return[1:62])), 2)
beta_materials2016_90 <- round((cov(materials2016$return[1:64], market2016$return[1:64]) / var(market2016$return[1:64])), 2)


######### Post elections

beta_consumerGoods2000_Post <- round((cov(consumerGoods2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_consumerGoods2004_Post <- round((cov(consumerGoods2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_consumerGoods2008_Post <- round((cov(consumerGoods2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_consumerGoods2012_Post <- round((cov(consumerGoods2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_consumerGoods2016_Post <- round((cov(consumerGoods2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_realEstate2000_Post <- round((cov(realEstate2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_realEstate2004_Post <- round((cov(realEstate2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_realEstate2008_Post<- round((cov(realEstate2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_realEstate2012_Post <- round((cov(realEstate2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_realEstate2016_Post <- round((cov(realEstate2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_telecommunications2000_Post <- round((cov(telecommunications2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_telecommunications2004_Post <- round((cov(telecommunications2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_telecommunications2008_Post <- round((cov(telecommunications2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_telecommunications2012_Post <- round((cov(telecommunications2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_telecommunications2016_Post <- round((cov(telecommunications2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_utilities2000_Post <- round((cov(utilities2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_utilities2004_Post <- round((cov(utilities2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_utilities2008_Post <- round((cov(utilities2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_utilities2012_Post <- round((cov(utilities2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_utilities2016_Post <- round((cov(utilities2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_technology2000_Post <- round((cov(technology2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_technology2004_Post <- round((cov(technology2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_technology2008_Post <- round((cov(technology2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_technology2012_Post <- round((cov(technology2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_technology2016_Post <- round((cov(technology2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_industrial2000_Post <- round((cov(industrial2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_industrial2004_Post <- round((cov(industrial2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_industrial2008_Post <- round((cov(industrial2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_industrial2012_Post <- round((cov(industrial2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_industrial2016_Post <- round((cov(industrial2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_financial2000_Post <- round((cov(financial2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_financial2004_Post <- round((cov(financial2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_financial2008_Post <- round((cov(financial2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_financial2012_Post <- round((cov(financial2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_financial2016_Post <- round((cov(financial2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_energy2000_Post <- round((cov(energy2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_energy2004_Post <- round((cov(energy2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_energy2008_Post <- round((cov(energy2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_energy2012_Post <- round((cov(energy2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_energy2016_Post <- round((cov(energy2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_consumerDiscretionary2000_Post <- round((cov(consumerDiscretionary2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_consumerDiscretionary2004_Post <- round((cov(consumerDiscretionary2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_consumerDiscretionary2008_Post <- round((cov(consumerDiscretionary2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_consumerDiscretionary2012_Post <- round((cov(consumerDiscretionary2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_consumerDiscretionary2016_Post <- round((cov(consumerDiscretionary2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_healthCare2000_Post <- round((cov(healthCare2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_healthCare2004_Post <- round((cov(healthCare2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_healthCare2008_Post <- round((cov(healthCare2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_healthCare2012_Post <- round((cov(healthCare2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_healthCare2016_Post <- round((cov(healthCare2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)

beta_materials2000_Post <- round((cov(materials2000$return[65:85], market2000$return[65:85]) / var(market2000$return[65:85])), 2)
beta_materials2004_Post <- round((cov(materials2004$return[65:85], market2004$return[65:85]) / var(market2004$return[65:85])), 2)
beta_materials2008_Post <- round((cov(materials2008$return[65:85], market2008$return[65:85]) / var(market2008$return[65:85])), 2)
beta_materials2012_Post <- round((cov(materials2012$return[63:83], market2012$return[63:83]) / var(market2012$return[63:83])), 2)
beta_materials2016_Post <- round((cov(materials2016$return[65:85], market2016$return[65:85]) / var(market2016$return[65:85])), 2)
```

**The following are graphs of the pre and post election betas**
```{r}
# Post election beta graphs
# Below is data for each market sector. I will write comments for only Consumer Goods (every other sector is identical with the exception of its name).

# x-axis data.
electionYears <- c("2000", "2004", "2008", "2012", "2016")

# y-axis data for Consumer Goods.
values_consumerGoodsBeta_90 <- c(beta_consumerGoods2000_90, beta_consumerGoods2004_90, beta_consumerGoods2008_90, beta_consumerGoods2012_90, beta_consumerGoods2016_90)
values_consumerGoodsBeta_Post <- c(beta_consumerGoods2000_Post, beta_consumerGoods2004_Post, beta_consumerGoods2008_Post, beta_consumerGoods2012_Post, beta_consumerGoods2016_Post)
# Turn x-axis and y-axis data into a data frame to use for ggplot2.
betas_consumerGoods_Aggregate <- data.frame(electionYears, values_consumerGoodsBeta_90, values_consumerGoodsBeta_Post)

mid = 0 # Used to create multiple gradients in one plot. Since beta can be negative or positive, the a beta of 0 means no market risk whatsoever. Thus, the midpoint is 0.

betasPlot_consumerGoods_Aggregate <- ggplot(data = betas_consumerGoods_Aggregate, aes(x = electionYears, y = values_consumerGoodsBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_consumerGoodsBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_consumerGoodsBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_consumerGoodsBeta_90, colour = values_consumerGoodsBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_consumerGoodsBeta_Post, colour = values_consumerGoodsBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") + # the gradient ranges from -2.5 to 2.5. Thus, -2.5 or 2.5 is pure red and anything in between is a mixture of green and red, depending on the value.
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") + # changed the y-axis label to 'Beta' with the addition of the actual Greek letter.
  xlab("Election Year") + # changed the x-axis label to 'Election Year'.
    labs(title = "Market risk of the consumer goods sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) + # changed title font size and made bold as well to stand out
  theme_solarized() + # changed the theme of the entire plot to make it more appealing rather than just black and white.
  theme(legend.position="none") # got rid of the legend because it is unnecessary.
betasPlot_consumerGoods_Aggregate



values_realEstateBeta_90 <- c(beta_realEstate2000_90, beta_realEstate2004_90, beta_realEstate2008_90, beta_realEstate2012_90, beta_realEstate2016_90)
values_realEstateBeta_Post <- c(beta_realEstate2000_Post, beta_realEstate2004_Post, beta_realEstate2008_Post, beta_realEstate2012_Post, beta_realEstate2016_Post)
betas_realEstate_Aggregate <- data.frame(electionYears, values_realEstateBeta_90, values_realEstateBeta_90, values_realEstateBeta_Post)
betasPlot_realEstate_Aggregate <- ggplot(data = betas_realEstate_Aggregate, aes(x = electionYears, y = values_realEstateBeta_90, group = 1)) +
    geom_line(aes(x = electionYears, y = values_realEstateBeta_90),linetype = "solid", color="purple") +
    geom_line(aes(x = electionYears, y = values_realEstateBeta_Post),linetype = "solid", color="orange") +
    geom_point(aes(x = electionYears, y = values_realEstateBeta_90, colour = values_realEstateBeta_90), size = 4) +
    geom_point(aes(x = electionYears, y = values_realEstateBeta_Post, colour = values_realEstateBeta_Post), size = 4) +
    scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
    scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
    ylab("Beta"~(beta)~"\n") +
    xlab("Election Year") +
      labs(title = "Market risk of the real estate sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized() +
    theme(legend.position="none")
betasPlot_realEstate_Aggregate



values_telecommunicationsBeta_90 <- c(beta_telecommunications2000_90, beta_telecommunications2004_90, beta_telecommunications2008_90, beta_telecommunications2012_90, beta_telecommunications2016_90)
values_telecommunicationsBeta_Post <- c(beta_telecommunications2000_Post, beta_telecommunications2004_Post, beta_telecommunications2008_Post, beta_telecommunications2012_Post, beta_telecommunications2016_Post)
betas_telecommunications_Aggregate <- data.frame(electionYears, values_telecommunicationsBeta_90, values_telecommunicationsBeta_Post)
betasPlot_telecommunications_Aggregate <- ggplot(data = betas_telecommunications_Aggregate, aes(x = electionYears, y = values_telecommunicationsBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_telecommunicationsBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_telecommunicationsBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_telecommunicationsBeta_90, colour = values_telecommunicationsBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_telecommunicationsBeta_Post, colour = values_telecommunicationsBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) +
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the telecommunications sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_telecommunications_Aggregate

values_utilitiesBeta_90 <- c(beta_utilities2000_90, beta_utilities2004_90, beta_utilities2008_90, beta_utilities2012_90, beta_utilities2016_90)
values_utilitiesBeta_Post <- c(beta_utilities2000_Post, beta_utilities2004_Post, beta_utilities2008_Post, beta_utilities2012_Post, beta_utilities2016_Post)
betas_utilities_Aggregate <- data.frame(electionYears, values_utilitiesBeta_90, values_utilitiesBeta_Post)
betasPlot_utilities_Aggregate <- ggplot(data = betas_utilities_Aggregate, aes(x = electionYears, y = values_utilitiesBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_utilitiesBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_utilitiesBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_utilitiesBeta_90, colour = values_utilitiesBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_utilitiesBeta_Post, colour = values_utilitiesBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the utilities sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_utilities_Aggregate

values_technologyBeta_90 <- c(beta_technology2000_90, beta_technology2004_90, beta_technology2008_90, beta_technology2012_90, beta_technology2016_90)
values_technologyBeta_Post <- c(beta_technology2000_Post, beta_technology2004_Post, beta_technology2008_Post, beta_technology2012_Post, beta_technology2016_Post)
betas_technology_Aggregate <- data.frame(electionYears, values_technologyBeta_90, values_technologyBeta_Post)
betasPlot_technology_Aggregate <- ggplot(data = betas_technology_Aggregate, aes(x = electionYears, y = values_technologyBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_technologyBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_technologyBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_technologyBeta_90, colour = values_technologyBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_technologyBeta_Post, colour = values_technologyBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the technology sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_technology_Aggregate

values_industrialBeta_90 <- c(beta_industrial2000_90, beta_industrial2004_90, beta_industrial2008_90, beta_industrial2012_90, beta_industrial2016_90)
values_industrialBeta_Post <- c(beta_industrial2000_Post, beta_industrial2004_Post, beta_industrial2008_Post, beta_industrial2012_Post, beta_industrial2016_Post)
betas_industrial_Aggregate <- data.frame(electionYears, values_industrialBeta_90, values_industrialBeta_Post)
betasPlot_industrial_Aggregate <- ggplot(data = betas_industrial_Aggregate, aes(x = electionYears, y = values_industrialBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_industrialBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_industrialBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_industrialBeta_90, colour = values_industrialBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_industrialBeta_Post, colour = values_industrialBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the industrial sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_industrial_Aggregate

values_financialBeta_90 <- c(beta_financial2000_90, beta_financial2004_90, beta_financial2008_90, beta_financial2012_90, beta_financial2016_90)
values_financialBeta_Post <- c(beta_financial2000_Post, beta_financial2004_Post, beta_financial2008_Post, beta_financial2012_Post, beta_financial2016_Post)
betas_financial_Aggregate <- data.frame(electionYears, values_financialBeta_90, values_financialBeta_Post)
betasPlot_financial_Aggregate <- ggplot(data = betas_financial_Aggregate, aes(x = electionYears, y = values_financialBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_financialBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_financialBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_financialBeta_90, colour = values_financialBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_financialBeta_Post, colour = values_financialBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the financial sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_financial_Aggregate

values_energyBeta_90 <- c(beta_energy2000_90, beta_energy2004_90, beta_energy2008_90, beta_energy2012_90, beta_energy2016_90)
values_energyBeta_Post <- c(beta_energy2000_Post, beta_energy2004_Post, beta_energy2008_Post, beta_energy2012_Post, beta_energy2016_Post)
values_energyBeta_Aggregate <- c(beta_energy2000_90, beta_energy2004_90, beta_energy2008_90, beta_energy2012_90, beta_energy2016_90, beta_energy2000_Post, beta_energy2004_Post, beta_energy2008_Post, beta_energy2012_Post, beta_energy2016_Post)
betas_energy_Aggregate <- data.frame(electionYears, values_energyBeta_90, values_energyBeta_Post)
betasPlot_energy_Aggregate <- ggplot(data = betas_energy_Aggregate, aes(x = electionYears, y = values_energyBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_energyBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_energyBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_energyBeta_90, colour = values_energyBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_energyBeta_Post, colour = values_energyBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the energy sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_energy_Aggregate

values_consumerDiscretionaryBeta_90 <- c(beta_consumerDiscretionary2000_90, beta_consumerDiscretionary2004_90, beta_consumerDiscretionary2008_90, beta_consumerDiscretionary2012_90, beta_consumerDiscretionary2016_90)
values_consumerDiscretionaryBeta_Post <- c(beta_consumerDiscretionary2000_Post, beta_consumerDiscretionary2004_Post, beta_consumerDiscretionary2008_Post, beta_consumerDiscretionary2012_Post, beta_consumerDiscretionary2016_Post)
betas_consumerDiscretionary_Aggregate <- data.frame(electionYears, values_consumerDiscretionaryBeta_90, values_consumerDiscretionaryBeta_Post)
betasPlot_consumerDiscretionary_Aggregate <- ggplot(data = betas_consumerDiscretionary_Aggregate, aes(x = electionYears, y = values_consumerDiscretionaryBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_consumerDiscretionaryBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_consumerDiscretionaryBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_consumerDiscretionaryBeta_90, colour = values_consumerDiscretionaryBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_consumerDiscretionaryBeta_Post, colour = values_consumerDiscretionaryBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the consumer discretionary sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_consumerDiscretionary_Aggregate

values_healthCareBeta_90 <- c(beta_healthCare2000_90, beta_healthCare2004_90, beta_healthCare2008_90, beta_healthCare2012_90, beta_healthCare2016_90)
values_healthCareBeta_Post <- c(beta_healthCare2000_Post, beta_healthCare2004_Post, beta_healthCare2008_Post, beta_healthCare2012_Post, beta_healthCare2016_Post)
betas_healthCare_Aggregate <- data.frame(electionYears, values_healthCareBeta_90, values_healthCareBeta_Post)
betasPlot_healthCare_Aggregate <- ggplot(data = betas_healthCare_Aggregate, aes(x = electionYears, y = values_healthCareBeta_90, group = 1)) +
  geom_line(aes(x = electionYears, y = values_healthCareBeta_90),linetype = "solid", color="purple") +
  geom_line(aes(x = electionYears, y = values_healthCareBeta_Post),linetype = "solid", color="orange") +
  geom_point(aes(x = electionYears, y = values_healthCareBeta_90, colour = values_healthCareBeta_90), size = 4) +
  geom_point(aes(x = electionYears, y = values_healthCareBeta_Post, colour = values_healthCareBeta_Post), size = 4) +
  scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
  scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
  ylab("Beta"~(beta)~"\n") +
  xlab("Election Year") +
    labs(title = "Market risk of the health care sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
  theme(axis.title=element_text(size = 12, face = "bold")) +
  theme_solarized() +
  theme(legend.position="none")
betasPlot_healthCare_Aggregate

values_materialsBeta_90 <- c(beta_materials2000_90, beta_materials2004_90, beta_materials2008_90, beta_materials2012_90, beta_materials2016_90)
values_materialsBeta_Post <- c(beta_materials2000_Post, beta_materials2004_Post, beta_materials2008_Post, beta_materials2012_Post, beta_materials2016_Post)
betas_materials_Aggregate <- data.frame(electionYears, values_materialsBeta_90, values_materialsBeta_90, values_materialsBeta_Post)
betasPlot_materials_Aggregate <- ggplot(data = betas_materials_Aggregate, aes(x = electionYears, y = values_materialsBeta_90, group = 1)) +
    geom_line(aes(x = electionYears, y = values_materialsBeta_90),linetype = "solid", color="purple") +
    geom_line(aes(x = electionYears, y = values_materialsBeta_Post),linetype = "solid", color="orange") +
    geom_point(aes(x = electionYears, y = values_materialsBeta_90, colour = values_materialsBeta_90), size = 4) +
    geom_point(aes(x = electionYears, y = values_materialsBeta_Post, colour = values_materialsBeta_Post), size = 4) +
    scale_color_gradient2(midpoint = mid, low="red", mid = "green", high="red", breaks=c(-2.5,0,2.5), labels=c("Market Risk (-2.5)","No Market Risk (0)","Market Risk (2.5)"), limits=c(-2.5,2.5), name = "") +
    scale_y_continuous(limits=c(-2.5, 2.5)) + # to change y-axis range.
    ylab("Beta"~(beta)~"\n") +
    xlab("Election Year") +
      labs(title = "Market risk of the materials sector, as represented by Beta", subtitle = "(tracked 90 days (purple) before and 30 days (orange) after each election)", caption = "\n\n21st century comparison, excl. 2020") +
    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized() +
    theme(legend.position="none")
betasPlot_materials_Aggregate
  
```

**differences**
```{r}
preAndPostDif <- c(values_consumerGoodsBeta_Post - values_consumerGoodsBeta_90,
values_realEstateBeta_Post - values_realEstateBeta_90,
values_telecommunicationsBeta_Post - values_telecommunicationsBeta_90,
values_utilitiesBeta_Post - values_utilitiesBeta_90,
values_technologyBeta_Post - values_technologyBeta_90,
values_industrialBeta_Post - values_industrialBeta_90,
values_financialBeta_Post - values_financialBeta_90,
values_energyBeta_Post - values_energyBeta_90,
values_consumerDiscretionaryBeta_Post - values_consumerDiscretionaryBeta_90,
values_healthCareBeta_Post - values_healthCareBeta_90,
values_materialsBeta_Post - values_materialsBeta_90)
preAndPostDif

###########

consumerGoodsDifOfPreAndPost_versus_winPercent <- lm((values_consumerGoodsBeta_Post - values_consumerGoodsBeta_90) ~ percentDiff)
df_consumerGoodsDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_consumerGoodsBeta)
consumerGoodsDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_consumerGoodsDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_consumerGoodsBeta_Post - values_consumerGoodsBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of consumer goods sector versus % won (or lost) by a Republican candidate")


realEstateDifOfPreAndPost_versus_winPercent <- lm((values_realEstateBeta_Post - values_realEstateBeta_90) ~ percentDiff)
df_realEstateDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_realEstateBeta)
realEstateDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_realEstateDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_realEstateBeta_Post - values_realEstateBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of real estate sector versus % won (or lost) by a Republican candidate")
realEstateDifOfPreAndPost_versus_winPercentPlot


telecommunicationsDifOfPreAndPost_versus_winPercent <- lm((values_telecommunicationsBeta_Post - values_telecommunicationsBeta_90) ~ percentDiff)
df_telecommunicationsDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_telecommunicationsBeta)
telecommunicationsDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_telecommunicationsDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_telecommunicationsBeta_Post - values_telecommunicationsBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of telecommunications sector versus % won (or lost) by a Republican candidate")


utilitiesDifOfPreAndPost_versus_winPercent <- lm((values_utilitiesBeta_Post - values_utilitiesBeta_90) ~ percentDiff)
df_utilitiesDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_utilitiesBeta)
utilitiesDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_utilitiesDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_utilitiesBeta_Post - values_utilitiesBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of utilities sector versus % won (or lost) by a Republican candidate")


technologyDifOfPreAndPost_versus_winPercent <- lm((values_technologyBeta_Post - values_technologyBeta_90) ~ percentDiff)
df_technologyDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_technologyBeta)
technologyDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_technologyDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_technologyBeta_Post - values_technologyBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of technology sector versus % won (or lost) by a Republican candidate")
technologyDifOfPreAndPost_versus_winPercentPlot


industrialDifOfPreAndPost_versus_winPercent <- lm((values_industrialBeta_Post - values_industrialBeta_90) ~ percentDiff)
df_industrialDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_industrialBeta)
industrialDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_industrialDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_industrialBeta_Post - values_industrialBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of industrial sector versus % won (or lost) by a Republican candidate")



financialDifOfPreAndPost_versus_winPercent <- lm((values_financialBeta_Post - values_financialBeta_90) ~ percentDiff)
df_financialDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_financialBeta)
financialDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_financialDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_financialBeta_Post - values_financialBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of financial sector versus % won (or lost) by a Republican candidate")



energyDifOfPreAndPost_versus_winPercent <- lm((values_energyBeta_Post - values_energyBeta_90) ~ percentDiff)
df_energyDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_energyBeta)
energyDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_energyDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_energyBeta_Post - values_energyBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of energy sector versus % won (or lost) by a Republican candidate")
energyDifOfPreAndPost_versus_winPercentPlot




consumerDiscretionaryDifOfPreAndPost_versus_winPercent <- lm((values_consumerDiscretionaryBeta_Post - values_consumerDiscretionaryBeta_90) ~ percentDiff)
df_consumerDiscretionaryDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_consumerDiscretionaryBeta)
consumerDiscretionaryDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_consumerDiscretionaryDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_consumerDiscretionaryBeta_Post - values_consumerDiscretionaryBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of consumer discretionary sector versus % won (or lost) by a Republican candidate")


healthCareDifOfPreAndPost_versus_winPercent <- lm((values_healthCareBeta_Post - values_healthCareBeta_90) ~ percentDiff)
df_healthCareDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_healthCareBeta)
healthCareDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_healthCareDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_healthCareBeta_Post - values_healthCareBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of health care sector versus % won (or lost) by a Republican candidate")
healthCareDifOfPreAndPost_versus_winPercentPlot


materialsDifOfPreAndPost_versus_winPercent <- lm((values_materialsBeta_Post - values_materialsBeta_90) ~ percentDiff)
df_materialsDifOfPreAndPost_versus_winPercent <- data.frame(percentDiff, values_materialsBeta)
materialsDifOfPreAndPost_versus_winPercentPlot <- ggplot(data = df_materialsDifOfPreAndPost_versus_winPercent, aes(x = percentDiff, y = (values_materialsBeta_Post - values_materialsBeta_90))) +
  geom_point() +
  geom_smooth(method = "lm", se=FALSE) +
  ggtitle("Difference of beta pre and post election of materials sector versus % won (or lost) by a Republican candidate")

```


```{r}
#Market Return Graphs
graphOfReturns2000 <- ggplot(data = market2000, aes(x = date, y = return)) + geom_smooth(method=lm, color = "red") + geom_point() +
  ylab("Return") +
    xlab("Month") +
      scale_y_continuous(limits=c(-.10, .10)) +

    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized()

graphOfReturns2004 <- ggplot(data = market2004, aes(x = date, y = return)) + geom_smooth(method=lm, color = "red") + geom_point() +
  ylab("Return") +
    xlab("Month") +
      scale_y_continuous(limits=c(-.10, .10)) +

    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized()

graphOfReturns2008 <- ggplot(data = market2008, aes(x = date, y = return)) + geom_smooth(method=lm, color = "blue") + geom_point() +
  ylab("Return") +
      scale_y_continuous(limits=c(-.10, .10)) +

    xlab("Month") +
    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized()

graphOfReturns2012 <- ggplot(data = market2012, aes(x = date, y = return)) + geom_smooth(method=lm, color = "blue") + geom_point() +
  ylab("Return") +
    xlab("Month") +
      scale_y_continuous(limits=c(-.10, .10)) +

    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized()

graphOfReturns2016 <- ggplot(data = market2016, aes(x = date, y = return)) + geom_smooth(method=lm, color = "red") + geom_point() +
  ylab("Return") +
    xlab("Month") +
    scale_y_continuous(limits=c(-.10, .10)) +

    theme(axis.title=element_text(size = 12, face = "bold")) +
    theme_solarized()



returnFigure <- ggarrange(graphOfReturns2000, graphOfReturns2004, graphOfReturns2008, graphOfReturns2012, graphOfReturns2016,
                    labels = c("2000", "2004", "2008", "2012", "2016"),
                    ncol = 3, nrow = 2)
returnFigure


```
**We have finished our analysis. Let us assess the linear assumptions of our regression models for one last extensive effort. Although the number of datapoints in each of our regression models is limitied (most have just five), we can still ensure that given the data that we are examining we can make some valid assumptions about the market.**
```{r}
####

####

####

####

```
```{r pressure, echo=FALSE}
plot(pressure)
```